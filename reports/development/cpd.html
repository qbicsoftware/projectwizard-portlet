<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from org.apache.maven.plugins:maven-pmd-plugin:3.11.0:cpd at 2021-05-20 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ProjectWizard Portlet &#x2013; CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">
ProjectWizard Portlet
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2021-05-20</span>
          &nbsp;| <span id="projectVersion">Version: 1.11.0-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="./" title="ProjectWizard Portlet">ProjectWizard Portlet</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="expanded"><a href="project-reports.html" title="Project Reports">Project Reports</a>
      <ul>
       <li class="none"><a href="checkstyle.html" title="Checkstyle">Checkstyle</a></li>
       <li class="none"><strong>CPD</strong></li>
       <li class="none"><a href="pmd.html" title="PMD">PMD</a></li>
       <li class="none"><a href="surefire-report.html" title="Surefire Report">Surefire Report</a></li>
       <li class="none"><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
       <li class="none"><a href="xref/index.html" title="Source Xref">Source Xref</a></li>
       <li class="none"><a href="gapidocs/index.html" title="Groovydocs">Groovydocs</a></li>
      </ul></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<div class="section">
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.8.0.</p></div>
<div class="section">
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/registration/OpenbisCreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisCreationController.html#L201">201</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/registration/OpenbisV3CreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisV3CreationController.html#L267">267</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * this is the one normally called!
   * 
   * @param tsvSampleHierarchy
   * @param description
   * @param secondaryName
   * @param bar
   * @param info
   * @param ready
   * @param user
   */
  @Override
  public void registerProjectWithExperimentsAndSamplesBatchWise(
      final List&lt;List&lt;ISampleBean&gt;&gt; tsvSampleHierarchy, final String description,
      final List&lt;OpenbisExperiment&gt; informativeExperiments, final ProgressBar bar, final Label info,
      final Runnable ready, Map&lt;String, Map&lt;String, Object&gt;&gt; entitiesToUpdate,
      final boolean isPilot) {
    errors = &quot;&quot;;

    RegisterableProject p =
        new RegisterableProject(tsvSampleHierarchy, description, informativeExperiments, isPilot);

    for (String experiment : entitiesToUpdate.keySet()) {
      String expID = ExperimentCodeFunctions.getExperimentIdentifier(p.getSpace(),
          p.getProjectCode(), experiment);
      long modificationTime = openbis.getExperimentById(expID).getModificationDate().getTime();

      updateExperiment(expID, entitiesToUpdate.get(experiment));

      long newModificationTime = modificationTime;
      double TIMEOUT = 10000;

      while (newModificationTime == modificationTime &amp;&amp; TIMEOUT &gt; 0) {
        newModificationTime = openbis.getExperimentById(expID).getModificationDate().getTime();
        TIMEOUT -= 300;
        try {
          Thread.sleep(300);
        } catch (InterruptedException e1) {
          // TODO Auto-generated catch block
          e1.printStackTrace();
        }

      }
      if (TIMEOUT &lt; 0) {
        errors = &quot;could not update existing experimental design, not registering samples!&quot;;
        logger.error(errors);
        return;
      } else {
        logger.debug(&quot;completed update of experimental design successfully&quot;);
      }
    }

    logger.debug(&quot;User sending samples: &quot; + user);
    Thread t = new Thread(new Runnable() {
      volatile int current = -1;

      @Override
      public void run() {
        info.setCaption(&quot;Collecting information&quot;);
        UI.getCurrent().access(new UpdateProgressBar(bar, info, 0.01));
        List&lt;RegisterableExperiment&gt; exps = p.getExperiments();
        String space = p.getSpace().toUpperCase();
        String project = p.getProjectCode();
        String desc = p.getDescription();

        int splitSteps = 0;
        // find out which experiments have so many samples they should be sent in multiple packages
        for (RegisterableExperiment exp : exps) {
          splitSteps += exp.getSamples().size() / (SPLIT_AT_ENTITY_SIZE + 1);
        }

        // final int todo = exps.size() + splitSteps + 1;// TODO huge number of samples should be
        // split
        // into groups
        final int todo = tsvSampleHierarchy.size() + splitSteps + 1;
        // of 50 or 100. this needs to be reflected in the progress
        // bar
        current++;
        double frac = current * 1.0 / todo;
        info.setCaption(&quot;Registering Project and Experiments&quot;);
        UI.getCurrent().access(new UpdateProgressBar(bar, info, frac));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/ExperimentImportController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/ExperimentImportController.html#L943">943</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/control/ExperimentImportController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/ExperimentImportController.html#L1007">1007</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            keyToFields.put(&quot;Q_IONIZATION_MODE&quot;, new HashSet&lt;&gt;(Arrays.asList(&quot;MS ion mode&quot;)));

            for (Map&lt;String, Object&gt; props : metadataList) {
              Map&lt;String, String&gt; newProps = new HashMap&lt;&gt;();
              for (String openBISPropertyKey : props.keySet()) {
                if (keyToFields.containsKey(openBISPropertyKey)) {

                  Set&lt;String&gt; columnNames = keyToFields.get(openBISPropertyKey);
                  
                  if (props.get(openBISPropertyKey) instanceof String) {
                    String oldEntry = (String) props.get(openBISPropertyKey);

                    // String newLabel = questionaire.getVocabularyLabelForValue(val, entry);//
                    String newVal = questionaire.getVocabularyCodeForValue(columnNames, oldEntry);
                    if (newVal != null) {
                      props.put(openBISPropertyKey, newVal);

                      //
                      // MetadataReplacementHelper.addNewReplacement(openBISPropertyKey, )
                    }
                  } else if (props.get(openBISPropertyKey) instanceof List&lt;?&gt;) {
                    
                    List&lt;String&gt; newPropList = new ArrayList&lt;&gt;();
                    List&lt;String&gt; propList = (List&lt;String&gt;) (List&lt;?&gt;) props.get(openBISPropertyKey);
                    
                    for (String entry : propList) {
                      String newEntry = questionaire.getVocabularyCodeForValue(columnNames, entry);
                      
                      if (newEntry != null) {
                        newPropList.add(newEntry);
                      } else {
                        newPropList.add(entry);
                      }
                    }
                    props.put(openBISPropertyKey, newPropList);
                  }
                }
              }
              for (String newProp : newProps.keySet()) {
                props.put(newProp, newProps.get(newProp));
              }
            }
            logger.info(&quot;after replacement:&quot;);
            logger.info(metadataList);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/registration/OpenbisCreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisCreationController.html#L427">427</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/registration/OpenbisV3CreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisV3CreationController.html#L590">590</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  public String getErrors() {
    return errors;
  }

  @Override
  public boolean setupEmptyProject(String space, String project, String description)
      throws JAXBException {
    registerProject(space, project, description);
    StudyXMLParser p = new StudyXMLParser();
    JAXBElement&lt;Qexperiment&gt; res =
        p.createNewDesign(new HashSet&lt;&gt;(), new ArrayList&lt;&gt;(), new HashMap&lt;&gt;(), new HashMap&lt;&gt;());
    String emptyStudy = p.toString(res);

    String exp = project + &quot;_INFO&quot;;
    String code = project + &quot;000&quot;;

    Map&lt;String, Object&gt; props = new HashMap&lt;&gt;();
    props.put(&quot;Q_EXPERIMENTAL_SETUP&quot;, emptyStudy);

    boolean success =
        registerExperiment(space, project, ExperimentType.Q_PROJECT_DETAILS, exp, props);
    if (!success) {
      // experiments were not registered, break registration
      errors = &quot;Info experiment could not be registered.&quot;;
      logger.error(errors);
      return false;
    }
    ISampleBean infoSample = new TSVSampleBean(code, exp, project, space,
        SampleType.Q_ATTACHMENT_SAMPLE, &quot;&quot;, new ArrayList&lt;String&gt;(), new HashMap&lt;String, Object&gt;());
    success = registerSampleBatch(new ArrayList&lt;ISampleBean&gt;(Arrays.asList(infoSample)));
    if (!success) {
      // experiments were not registered, break registration
      errors = &quot;Info sample could not be registered.&quot;;
      logger.error(errors);
      return false;
    } else {
      return true;
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/adminviews/MCCView.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCView.html#L148">148</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/adminviews/MCCViewNew.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCViewNew.html#L154">154</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    paramTab.addComponent(timepoint);

    existingPatients = new Table(&quot;Existing Patients&quot;);
    existingPatients.setStyleName(Styles.tableTheme);
    existingPatients.setPageLength(1);

    editView = new TabSheet();
    editView.addStyleName(ValoTheme.TABSHEET_FRAMED);

    samples = new Table(&quot;Samples&quot;);
    samples.setStyleName(Styles.tableTheme);
    samples.setPageLength(1);

    metaData = new Table();
    metaData.setEditable(true);
    metaData.setStyleName(Styles.tableTheme);

    editView.addTab(samples, &quot;Overview&quot;);
    editView.addTab(metaData, &quot;Change Metadata&quot;);
    editView.setVisible(false);

    registerInfo = new Label();
    bar = new ProgressBar();
    addSamples = new Button(&quot;Add Samples&quot;);
    addSamples.setEnabled(false);
    initMCCListeners();
    addComponent(Styles.questionize(projectTab,
        &quot;Samples can only be added if Timepoint, Treatment, Project and Patient Number &quot;
            + &quot;are filled in and they don't already exist in the current project. E.g. you can add a new timepoint for the same patient and &quot;
            + &quot;treatment but not the same timepoint.&quot;,
        &quot;Adding new Samples&quot;));
    addComponent(paramTab);
    addComponent(existingPatients);
    addComponent(editView);
    addComponent(registerInfo);
    addComponent(bar);
    addComponent(addSamples);
  }

  private boolean allValid() {
    boolean project = !newProject.isEmpty() || mccProjects.getValue() != null;
    boolean treat = !treatment.isEmpty();
    boolean pat = !patient.isEmpty() &amp;&amp; patient.getValue().matches(&quot;[1-9][0-9]*&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/adminviews/MCCView.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCView.html#L238">238</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/adminviews/MCCViewNew.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCViewNew.html#L241">241</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    timepoint.addValueChangeListener(check);
    patient.addValueChangeListener(check);

    newProject.addValueChangeListener(new ValueChangeListener() {

      /**
       * 
       */
      private static final long serialVersionUID = -7747648379674835869L;

      @Override
      public void valueChange(ValueChangeEvent event) {
        if (!newProject.isEmpty())
          counter = new SampleCounter(newProject.getValue());
        for (Sample s : openbis.getSamplesOfProject(&quot;/&quot; + mccSpace + &quot;/&quot; + newProject.getValue()))
          counter.increment(s);
        addSamples.setEnabled(allValid());
      }
    });

    mccProjects.addValueChangeListener(new ValueChangeListener() {

      /**
       * 
       */
      private static final long serialVersionUID = 354186297920828100L;

      @Override
      public void valueChange(ValueChangeEvent event) {
        projectBoxChanged();
      }
    });

    addSamples.addClickListener(new Button.ClickListener() {
      /**
       * 
       */
      private static final long serialVersionUID = -3356594300480093815L;

      @Override
      public void buttonClick(ClickEvent event) {
        logger.info(&quot;Adding MCC Patient.&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/registration/OpenbisCreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisCreationController.html#L182">182</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/registration/OpenbisV3CreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisV3CreationController.html#L177">177</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      openbis.ingest(&quot;DSS1&quot;, &quot;register-exp&quot;, params);
    }
    return true;
  }

  private List&lt;List&lt;ISampleBean&gt;&gt; splitSamplesIntoBatches(List&lt;ISampleBean&gt; samples,
      int targetSize) {
    List&lt;List&lt;ISampleBean&gt;&gt; res = new ArrayList&lt;List&lt;ISampleBean&gt;&gt;();
    int size = samples.size();
    if (size &lt; targetSize)
      return new ArrayList&lt;List&lt;ISampleBean&gt;&gt;(Arrays.asList(samples));
    for (int i = 0; i &lt; size / targetSize; i++) {
      int from = i * targetSize;
      int to = (i + 1) * targetSize;
      res.add(samples.subList(from, to));
      if (to &gt; size - targetSize &amp;&amp; to != size)
        res.add(samples.subList(to, size));
    }
    return res;
  }

  /**
   * this is the one normally called!
   * 
   * @param tsvSampleHierarchy
   * @param description
   * @param secondaryName
   * @param bar
   * @param info
   * @param ready
   * @param user
   */
  @Override
  public void registerProjectWithExperimentsAndSamplesBatchWise(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/WizardController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardController.html#L409">409</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/control/WizardController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardController.html#L443">443</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          boolean afterMS = w.getSteps().contains(steps.get(Steps.Protein_Fractionation));
          if (afterMS) {
            List&lt;String&gt; infos = new ArrayList&lt;String&gt;();
            String protInfo = protFracStep.getAdditionalInfo();
            if (protInfo != null &amp;&amp; !protInfo.isEmpty()) {
              infos.add(protInfo);
            }
            String pepInfo = pepFracStep.getAdditionalInfo();
            if (pepInfo != null &amp;&amp; !pepInfo.isEmpty()) {
              infos.add(pepInfo);
            }
            if (!infos.isEmpty()) {
              Date now = new Date();
              SimpleDateFormat ft = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;);
              for (String comment : infos) {
                Note note = new Note();
                note.setComment(comment);
                note.setUsername(user);
                note.setTime(ft.format(now));
                notes.add(note);
              }
            }
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/steps/MSAnalyteStep.java</td>
<td><a href="./xref/life/qbic/projectwizard/steps/MSAnalyteStep.html#L614">614</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/uicomponents/MSSampleMultiplicationTable.java</td>
<td><a href="./xref/life/qbic/projectwizard/uicomponents/MSSampleMultiplicationTable.html#L390">390</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        ComboBox b = parseBoxRow(baseAnalyteSampleTable, row, &quot;Enzyme&quot;);
        if (enzymes.isEmpty()) {
          Styles.notification(&quot;No enzymes selected&quot;, &quot;Please select at least one enzyme!&quot;,
              NotificationType.ERROR);
        } else if (enzymes.size() == 1) {
          b.setValue(enzymes.get(0));
          subWindow.close();
        } else {
          b.addItem(&quot;Custom&quot;);
          b.setValue(&quot;Custom&quot;);
          enzymeMap.put(row, enzymes);
          subWindow.close();
        }
      }
    });
    layout.addComponent(pan);
    layout.addComponent(ok);

    subWindow.setContent(layout);
    // Center it in the browser window
    subWindow.center();
    subWindow.setModal(true);
    subWindow.setIcon(FontAwesome.FLASK);
    subWindow.setResizable(false);
    ProjectWizardUI ui = (ProjectWizardUI) UI.getCurrent();
    ui.addWindow(subWindow);
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/adminviews/MCCView.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCView.html#L208">208</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/adminviews/MCCViewNew.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCViewNew.html#L212">212</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    String id = ExperimentCodeFunctions.getInfoExperimentID(space, project);
    Experiment exp = openbis.getExperimentById(id);
    if (exp == null) {
      designExperiment = null;
      logger.error(&quot;could not find info experiment for project&quot; + project);
    } else {
      if (exp.getType().getCode().equalsIgnoreCase(ExperimentType.Q_PROJECT_DETAILS.name())) {
        designExperiment = exp;
        expDesign =
            xmlParser.parseXMLString(designExperiment.getProperties().get(&quot;Q_EXPERIMENTAL_SETUP&quot;));
        logger.debug(&quot;setting exp design: &quot; + expDesign);
      }
    }
  }

  private void initMCCListeners() {

    ValueChangeListener check = new ValueChangeListener() {

      /**
       * 
       */
      private static final long serialVersionUID = -7015950228583952364L;

      @Override
      public void valueChange(ValueChangeEvent event) {
        addSamples.setEnabled(allValid());
      }
    };
    treatment.addValueChangeListener(check);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/steps/MSAnalyteStep.java</td>
<td><a href="./xref/life/qbic/projectwizard/steps/MSAnalyteStep.html#L1022">1022</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/uicomponents/GeneralMSInfoPanel.java</td>
<td><a href="./xref/life/qbic/projectwizard/uicomponents/GeneralMSInfoPanel.html#L142">142</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    lcmsMethods = new ArrayList&lt;String&gt;();
    if (prefix.isEmpty()) {
      devices.addAll(vocabs.getMSDeviceMap().keySet());
    } else {
      for (String device : vocabs.getMSDeviceMap().keySet()) {
        if (device.contains(&quot;(&quot; + prefix + &quot;)&quot;) || dontFilter.contains(device))
          devices.add(device);
      }
    }
    for (String lcmsMethod : vocabs.getLcmsMethods()) {
      if (lcmsMethod.startsWith(prefix) || dontFilter.contains(lcmsMethod))
        lcmsMethods.add(lcmsMethod);
    }
    Collections.sort(devices);
    Collections.sort(lcmsMethods);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/steps/MSAnalyteStep.java</td>
<td><a href="./xref/life/qbic/projectwizard/steps/MSAnalyteStep.html#L643">643</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/uicomponents/MSSampleMultiplicationTable.java</td>
<td><a href="./xref/life/qbic/projectwizard/uicomponents/MSSampleMultiplicationTable.html#L172">172</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      final int rowID) {
    HorizontalLayout complexComponent = new HorizontalLayout();
    complexComponent.setWidth(contentBox.getWidth() + 10, contentBox.getWidthUnits());
    complexComponent.addComponent(contentBox);
    complexComponent.setExpandRatio(contentBox, 1);

    Button copy = new Button();
    Styles.iconButton(copy, FontAwesome.ARROW_CIRCLE_O_DOWN);
    copy.setStyleName(ValoTheme.BUTTON_BORDERLESS_COLORED);
    VerticalLayout vBox = new VerticalLayout();
    vBox.setWidth(&quot;15px&quot;);
    vBox.addComponent(copy);
    complexComponent.addComponent(vBox);
    complexComponent.setComponentAlignment(vBox, Alignment.BOTTOM_RIGHT);
    copy.addClickListener(new ClickListener() {

      @Override
      public void buttonClick(ClickEvent event) {
        ComboBox b = parseBoxRow(t, rowID, propertyName);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/WizardController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardController.html#L1008">1008</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/control/WizardController.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardController.html#L1056">1056</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>              dataAggregator.createFractionationSamplesAndExperiments();
            }
            createTSV();
            try {
              prep.processTSV(dataAggregator.getTSV(), new QBiCDesignReader(), false);
            } catch (IOException | JAXBException e) {
              e.printStackTrace();
            }
            armDownloadButtons(regStep.getDownloadButton());
            List&lt;SampleSummaryBean&gt; summaries = prep.getSummary();
            Map&lt;String, String&gt; taxMap = new HashMap&lt;String, String&gt;();
            for (Map.Entry&lt;String, String&gt; entry : vocabularies.getTaxMap().entrySet())
              taxMap.put(entry.getValue(), entry.getKey());
            for (SampleSummaryBean s : summaries) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/adminviews/MCCView.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCView.html#L119">119</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/adminviews/MCCViewNew.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCViewNew.html#L128">128</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    this.patients = new ArrayList&lt;String&gt;();

    mccProjects = new ComboBox(&quot;Source Project&quot;);
    List&lt;String&gt; projects = new ArrayList&lt;String&gt;();
    for (Project p : openbis.getProjectsOfSpace(mccSpace))
      projects.add(p.getCode());
    mccProjects.addStyleName(Styles.boxTheme);
    mccProjects.addItems(projects);
    mccProjects.setImmediate(true);

    newProject = new StandardTextField(&quot;New Project&quot;);
    newProject.setImmediate(true);
    newProject.setWidth(&quot;80px&quot;);

    HorizontalLayout projectTab = new HorizontalLayout();
    projectTab.setSpacing(true);
    projectTab.addComponent(mccProjects);
    projectTab.addComponent(newProject);

    treatment = new StandardTextField(&quot;Treatment&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/adminviews/MCCView.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCView.html#L300">300</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/adminviews/MCCViewNew.java</td>
<td><a href="./xref/life/qbic/projectwizard/adminviews/MCCViewNew.html#L301">301</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            newDesignXML = xmlParser.toString(newDesign);
          } catch (JAXBException e) {
            logger.error(&quot;could not create new design xml&quot;);
            e.printStackTrace();
          }
          String exp = project + &quot;_INFO&quot;;
          props.put(&quot;Q_EXPERIMENTAL_SETUP&quot;, newDesignXML);
          infoExperiments.add(new OpenbisExperiment(exp, ExperimentType.Q_PROJECT_DETAILS, props));
          String code = project + &quot;000&quot;;
          ISampleBean infoSample =
              new TSVSampleBean(code, exp, project, mccSpace, SampleType.Q_ATTACHMENT_SAMPLE, &quot;&quot;,
                  new ArrayList&lt;String&gt;(), new HashMap&lt;String, Object&gt;());
          samps.add(new ArrayList&lt;ISampleBean&gt;(Arrays.asList(infoSample)));
        }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/WizardDataAggregator.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardDataAggregator.html#L862">862</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/control/WizardDataAggregator.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardDataAggregator.html#L953">953</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      }
      Map&lt;String, String&gt; p = s.getProperties();
      List&lt;Property&gt; factors = new ArrayList&lt;&gt;();

      for (String label : oldFactors) {
        Property f = oldFactorsForSamples.get(new ImmutablePair&lt;&gt;(label, code));
        if (f != null) {
          factors.add(f);
          String name = f.getValue();
          if (f.hasUnit()) {
            name += f.getUnit();
          }
          factorMap.put(name, f);
        }
      }

      // List&lt;Property&gt; factors =
      // xmlParser.getExpFactors(xmlParser.parseXMLString(p.get(&quot;Q_PROPERTIES&quot;)));
      // for (Property f : factors) {
      // String name = f.getValue() + f.getUnit();
      // factorMap.put(name, f);
      // }
      res.add(new OpenbisBiologicalEntity(code, spaceCode, expCode, p.get(&quot;Q_SECONDARY_NAME&quot;),</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/registration/OpenbisCreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisCreationController.html#L309">309</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/registration/OpenbisV3CreationController.java</td>
<td><a href="./xref/life/qbic/projectwizard/registration/OpenbisV3CreationController.html#L372">372</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          info.setCaption(&quot;Registering samples&quot;);
          current++;
          frac = current * 1.0 / todo;
          UI.getCurrent().access(new UpdateProgressBar(bar, info, frac));
          boolean batchSuccess;
          if (level.size() &gt; SPLIT_AT_ENTITY_SIZE) {
            for (List&lt;ISampleBean&gt; batch : splitSamplesIntoBatches(level, SPLIT_AT_ENTITY_SIZE)) {
              batchSuccess = registerSampleBatch(batch);
              if (!batchSuccess) {
                bar.setVisible(false);
                info.setCaption(&quot;An error occured.&quot;);
                UI.getCurrent().setPollInterval(-1);
                UI.getCurrent().access(ready);
                return;
              }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/WizardDataAggregator.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardDataAggregator.html#L863">863</a></td></tr>
<tr class="a">
<td>life/qbic/projectwizard/control/WizardDataAggregator.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardDataAggregator.html#L909">909</a></td></tr>
<tr class="b">
<td>life/qbic/projectwizard/control/WizardDataAggregator.java</td>
<td><a href="./xref/life/qbic/projectwizard/control/WizardDataAggregator.html#L954">954</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Map&lt;String, String&gt; p = s.getProperties();
      List&lt;Property&gt; factors = new ArrayList&lt;&gt;();

      for (String label : oldFactors) {
        Property f = oldFactorsForSamples.get(new ImmutablePair&lt;&gt;(label, code));
        if (f != null) {
          factors.add(f);
          String name = f.getValue();
          if (f.hasUnit()) {
            name += f.getUnit();
          }
          factorMap.put(name, f);
        }
      }

      // List&lt;Property&gt; factors =
      // xmlParser.getExpFactors(xmlParser.parseXMLString(p.get(&quot;Q_PROPERTIES&quot;)));
      // for (Property f : factors) {
      // String name = f.getValue() + f.getUnit();
      // factorMap.put(name, f);
      // }
      res.add(new OpenbisBiologicalEntity(code, spaceCode, expCode, p.get(&quot;Q_SECONDARY_NAME&quot;),</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2021.All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
